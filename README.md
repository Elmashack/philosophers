ЗАДАЧА ОБ ОБЕДАЮЩИХ ФИЛОСОФАХ

Классический пример, используемый в информатике для иллюстрации проблем синхронизации при разработке параллельных алгоритмов и техник решения этих проблем.
Постановка задачи

Пять безмолвных философов сидят вокруг круглого стола, перед каждым философом стоит тарелка спагетти. Вилки лежат на столе между каждой парой ближайших философов. Каждый философ может либо есть, либо размышлять. Приём пищи не ограничен количеством оставшихся спагетти — подразумевается бесконечный запас. Тем не менее, философ может есть только тогда, когда держит две вилки — взятую справа и слева. Каждый философ может взять ближайшую вилку (если она доступна) или положить — если он уже держит её. Взятие каждой вилки и возвращение её на стол являются раздельными действиями, которые должны выполняться одно за другим. Вопрос задачи заключается в том, чтобы разработать модель поведения (параллельный алгоритм), при котором ни один из философов не будет голодать, то есть будет вечно чередовать приём пищи и размышления.
Решение

В основной части решения на CИ каждый философ это поток, в качестве вилок используются мьютексы, каждому философу доступны только две вилки - слева и справа от него.
Четные философы берут сначала вилку слева, потом вилку справа. Нечетные философы сначала берут вилку справа, потом вилку слева. Если количество философов нечетное - последний философ начинает искать вилку с небольшой задержкой.

В бонусной части философы это процессы, вилки представлены семафорами, каждому философу доступны все вилки.
Чтобы избежать дедлока философ проверяет сколько вилок осталось на столе, если вилок на столе меньше двух, то философ ждет, если больше одной - фиилософ берет сразу две вилки.

Решение на GO сделано в формате решения основной части на СИ.
Запуск

CИ, основная часть:

  make
  ./philosophers 5 400 200 190 3

CИ, бонусная часть:

  make bonus
  ./bonus_philosophers 5 400 200 190 3

golang:

  go run ./ 5 400 200 190 3

где:

    5 - количество философоф.
    400 - время жизни философа без приема пищи в миллисекундах.
    200 - время, необходимое философу для приема пищи в миллисекундах.
    190 - время, необходимое философу для сна в миллисекундах.
    3 - количество приемов пищи после которого философ наестся, когда все философы сыты программы завершается. Необязательный аргумент, если не указать его, программа будет работать пока один из философоф не умрет.
